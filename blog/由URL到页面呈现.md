# 大龄电力汪前端学习路 （从输入URL到页面呈现）

虽然日常生活中大家可能已经无数次的使用过浏览器浏览网页，可是我们是否曾想过当我们在浏览器地址栏输入地址后，计算机到底进行了那些操作才将对应网站页面呈现在我们面前呢？现在就由我来给大家进行一个简单的讲解。

简单可以理解为一下几个步骤：

1. 输入URL
2. 域名解析
3. 服务器处理
4. 浏览器绘制页面

## 输入URL
URL的格式一般为：`协议类型://<主机名>:<端口>/<路径>/文件名`

协议类型可以是http（超文本传输协议）、https（加密的文本传输协议） 、ftp（文件传输协议）、telnet（远程登录协议）、file（本地文件传输协议）等等。而http是最常见的网络传输协议，https则是进行加密的网络传输。
以`https://www.zhihu.com/people/activities`为例，https表示与web服务器通讯采用https协议，知乎web服务器域名为`www.zhihu.com`，`/people/activities`表示所访问的文件存在于知乎web服务器上的路径。

对于 `https://www.zhihu.com`的URL，浏览器实际上并不知道`www.zhihu.com`到底是什么东西，它需要查找`zhihu.com`网站所在服务器的IP地址，才能找到目标服务器。这就是下文要说的域名解析即DNS解析。

>注：URL（Uniform Resource Locator），统一资源定位符，用于定位互联网上的资源，实际上就是网站网址。IP是因特网中的每台连接到网络的计算机为实现相互通信而遵循的规则协议，每个处于互联网中的设备都有IP地址，形如 192.168.0.1，而127.0.0.1代表本机的 IP。IP又分为局域网IP和公网IP。而局域网 IP 和公网 IP 是有差别的。每个网站就是靠IP来定位的。

## DNS解析
DNS解析充当了一个翻译的角色，实现了网址URL到实际IP地址的转换，那么它是如何进行解析的。

浏览器缓存 – 浏览器会缓存DNS记录一段时间  
系统缓存 - 从 系统的Hosts 文件中查找是否有该域名和对应 IP。  
路由器缓存 – 一般路由器也会缓存域名信息。  
ISP(Internet Service Provider) DNS 缓存 – 网络运营商的DNS缓存，比如到电信的 DNS 上查找缓存。  
如果都没有找到，则继续向根域名服务器查找域名对应 IP，根域名服务器把请求转发到下一级，直到找到对应 IP。  

## 服务器处理
目标服务器都会安装处理请求的应用web sever，常见的 web sever产品有 Apache、Nginx、IIS、Lighttpd等。 当web server接收到一个HTTP请求(request)，就会返回一个HTTP响应(response)，例如返回一个HTML页面。对于不同用户发送的请求，会结合配置文件，把不同请求委托给服务器上处理对应请求的程序进行处理（例如CGI脚本，JSP脚本，servlets，ASP脚本，服务器端JavaScript，或者一些其它的服务器端技术等）。  
无论它们(脚本)的目的如何，这些服务器端(server-side)的程序通常产生一个HTML的响应(response)来让浏览器可以浏览。  
那么如何处理请求？实际上就是后台处理的工作。后台开发现在有很多框架，但大部分都还是按照MVC设计模式进行搭建的。  
处理的过程如下图： 
>MVC模型（model）-视图（view）-控制器（controller）  
 
![MVCM模型](https://i.loli.net/2018/01/22/5a65d0dea476b.jpg)

## 浏览器绘制页面
那么接下来就是浏览器进行处理， 通过后台处理返回的html字符串被浏览器接受后一句句读取解析，html页面经历加载、解析、渲染。

### 加载
浏览器对一个html页面的加载顺序是从上而下的。如果加载过程中遇到外部css文件，浏览器另外发出一个请求，来获取css文件。遇到图片资源，浏览器也会另外发出一个请求，来获取图片资源。但是当文档加载过程中遇到js文件，html文档会挂起渲染（加载解析渲染同步）的线程，不仅要等待文档中js文件加载完毕，还要等待解析执行完毕，才可以恢复html文档的渲染过程。

### 解析
解析文档是指将文档转化成为有意义的结构，也就是可让代码理解和使用的结构。解析得到的结果通常是代表了文档结构的节点树，它称作解析树或者语法树，也就是DOM树。如下图：  
![DOM树](https://i.loli.net/2018/01/22/5a65d1bd87b8a.jpg)




css解析将css文件解析为样式表对象。如下图：  
![css解析](https://i.loli.net/2018/01/22/5a65d1fcb2403.jpg)


js解析文件在加载的同时也进行解析
如果想深入如何解析的话可以看[浏览器的工作原理：新式网络浏览器幕后揭秘](http://blog.csdn.net/youmingyu/article/details/53400630)这篇文章

### 渲染
即为构建渲染树的过程，就是将DOM树进行可视化表示。构建这棵树是为了以正确的顺序绘制文档内容。
最终我们的浏览器就会根据 HTML 和 CSS 计算得到渲染树，绘制到页面上。





以上即为从用户在浏览器地址栏输入URL浏览器显示网站内容的全过程，由于本人的能力有限，如果哪里写的不对的话，请指出！谢谢！！！